    </main>
  </div>

  <script nonce="<%= cspNonce %>">
    // Sidebar functionality with improved animations
    const sidebarEl = document.getElementById('sidebar');
    const overlayEl = document.getElementById('overlay');
    const openSidebarEl = document.getElementById('openSidebar');
    const closeSidebarEl = document.getElementById('closeSidebar');

    function showSidebar() {
      sidebarEl.classList.remove('-translate-x-full');
      overlayEl.classList.remove('hidden');
      document.body.classList.add('overflow-hidden', 'lg:overflow-auto');
      // Add animation class
      setTimeout(() => overlayEl.classList.add('opacity-100'), 10);
    }

    function hideSidebar() {
      sidebarEl.classList.add('-translate-x-full');
      overlayEl.classList.remove('opacity-100');
      setTimeout(() => {
        overlayEl.classList.add('hidden');
        document.body.classList.remove('overflow-hidden', 'lg:overflow-auto');
      }, 300);
    }

    openSidebarEl?.addEventListener('click', showSidebar);
    closeSidebarEl?.addEventListener('click', hideSidebar);
    overlayEl?.addEventListener('click', hideSidebar);

    // Enhanced time display
    function updateTime() {
      const now = new Date();
      const timeString = now.toLocaleTimeString('en-US', { 
        hour12: true, 
        hour: '2-digit', 
        minute: '2-digit'
      });
      const timeElement = document.getElementById('currentTime');
      if (timeElement && timeElement.textContent !== timeString) {
        timeElement.textContent = timeString;
      }
    }

    updateTime();
    setInterval(updateTime, 30000);

    // Enhanced active link highlighting
    const currentPath = window.location.pathname;
    const navLinks = document.querySelectorAll('aside nav a');
    
    navLinks.forEach(link => {
      const href = link.getAttribute('href');
      if (href === currentPath || 
          (currentPath.includes(href) && href !== '/' && href.length > 1)) {
        link.classList.add('bg-gradient-to-r', 'from-blue-100', 'to-purple-100', 'text-blue-700', 'font-semibold', 'shadow-sm');
        link.classList.remove('text-gray-700');
      }
    });

    // Responsive sidebar handling
    function handleResize() {
      if (window.innerWidth >= 1024) {
        hideSidebar();
      }
    }

    window.addEventListener('resize', handleResize);

    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        hideSidebar();
      }
    });

    // Touch gestures for mobile
    let touchStartX = 0;
    let touchEndX = 0;

    document.addEventListener('touchstart', (e) => {
      touchStartX = e.changedTouches[0].screenX;
    });

    document.addEventListener('touchend', (e) => {
      touchEndX = e.changedTouches[0].screenX;
      handleSwipe();
    });

    function handleSwipe() {
      const swipeThreshold = 100;
      const diff = touchStartX - touchEndX;
      
      if (Math.abs(diff) > swipeThreshold) {
        if (diff > 0 && !sidebarEl.classList.contains('-translate-x-full')) {
          // Swipe left - close sidebar
          hideSidebar();
        } else if (diff < 0 && sidebarEl.classList.contains('-translate-x-full') && touchStartX < 50) {
          // Swipe right from edge - open sidebar
          showSidebar();
        }
      }
    }

    // Loading states for navigation
    navLinks.forEach(link => {
      link.addEventListener('click', function(e) {
        if (this.href && !this.href.includes('#')) {
          const icon = this.querySelector('i');
          if (icon) {
            icon.className = 'fas fa-spinner fa-spin w-5 text-center';
          }
        }
      });
    });
  </script>
</body>
</html>

